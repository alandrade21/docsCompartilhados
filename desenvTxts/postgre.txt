Instalação
----------

- Adiciona no sources.list

deb http://apt.postgresql.org/pub/repos/apt/ stretch-pgdg main

- Importar a chave do repositório

$ sudo wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | \
  sudo apt-key add -

- Instalação

$ sudo apt-get update
$ sudo apt-get install postgresql-9.6
$ sudo apt-get install pgadmin3
$ sudo apt-get install postgresql-contrib-9.6

Serviço
-------

- sudo pg_ctlcluster 9.6 main status

- sudo pg_ctlcluster 9.6 main stop

- sudo pg_ctlcluster 9.6 main start


Senha Primeiro acesso
---------------------

$ sudo passwd postgres

$ su postgres

$ psql -c "ALTER USER postgres WITH PASSWORD 'nova_senha'" -d template1


Mover Diretório de Dados de lugar
----------------------------------

- Confere o lugar atual

$ sudo -u postgres psql

postgres=# SHOW data_directory;

- vaiaparecer algo como

       data_directory       
------------------------------
/var/lib/postgresql/9.6/main
(1 row)

- Saia do console postgres

postgres=# \q

- Para o postgres

$ sudo systemctl stop postgresql
$ sudo systemctl status postgresql

- Copia a pasta

$ sudo rsync -av /var/lib/postgresql /opt/

- Renomeia a antiga, por segurança

$ sudo mv /var/lib/postgresql/9.6/main /var/lib/postgresql/9.6/main.bak

- Abra o arquivo /etc/postgresql/9.6/main/postgresql.conf e altere o diretório.

- Reinicia o server

$ sudo systemctl start postgresql
$ sudo systemctl status postgresql
$ sudo pg_ctlcluster 9.6 main start
$ sudo pg_ctlcluster 9.6 main status

- Verifica a configuração

$ sudo -u postgres psql
postgres=# SHOW data_directory;
postgres=# \q

- Remove o diretório anterior

$ sudo rm -Rf /var/lib/postgresql/9.6/main.bak

- Preparar servidor para acesso remoto
--------------------------------------

edite /etc/postgresql/9.6/main/postgresql.conf e localize a entrada listen_addresses e descomente-a. Configure-a para:
listen_addresses = '*'

Edite o arquivo /etc/postgresql/9.6/main/pg_hba.conf e altere a entrada host all para:
host all all 0.0.0.0/0 md5

Reinicie o servidor.




